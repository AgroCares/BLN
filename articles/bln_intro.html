<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BLN introduction • BLN</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BLN introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BLN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bln_column_description.html">Description of the input and output for BLN</a></li>
    <li><a class="dropdown-item" href="../articles/bln_ess_crop_production.html">BLN assessment for crop production</a></li>
    <li><a class="dropdown-item" href="../articles/bln_intro.html">BLN introduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AgroCares/BLN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>BLN introduction</h1>
                        <h4 data-toc-skip class="author">Gerard H.
Ros</h4>
            
            <h4 data-toc-skip class="date">2025-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AgroCares/BLN/blob/v0.9.0/vignettes/bln_intro.Rmd" class="external-link"><code>vignettes/bln_intro.Rmd</code></a></small>
      <div class="d-none name"><code>bln_intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="bln-introduction">BLN introduction<a class="anchor" aria-label="anchor" href="#bln-introduction"></a>
</h2>
<p>The crucial role of healthy soil in achieving sustainable food
production and environment is increasingly recognized, as is the
importance of proper assessment of soil quality. Healthy soils are not
just a growing medium for crops, but they regulate and support essential
ecosystem services, such as water purification, carbon sequestration,
and nutrient cycling, and they provide habitats for biodiversity.
Improving and sustaining soil health are therefore key to sustainable
crop production. To date, many attempts have been made to develop
indices for assessing soil health, but an operational and reproducible
methodology to assess soil health has not been developed so far. There
is a broad consensus that multiple aspects of soils (e.g., chemistry,
structure, and biology) and their interactions need to be considered.
Further, various approaches have been proposed to translate soil
attributes into indicators and aggregate them into an index, including
(advanced) statistical methods and refined expert knowledge systems.
These approaches however are often highly dependent on costly soil
measures, are difficult to interpret, and not easily applicable across
spatial scales, ranging from field to regions. To overcome these
challenges, Ros et al. (2021) introduced a new soil assessment
framework, being the open soil index (OSI). The OSI builds on extensive
soil and agronomic research to maintain a direct link to the objective
(which is sustainable crop production), leverages routine laboratory
data and public databases to make its large-scale application
affordable, has a modular design to allow for easy adjustment and
expansion, is developed in an open-source environment to assure
transparency, and provides advice for field-level farming practices. In
this way, OSI strives to provide an operational soil assessment that
valorizes soil health and therewith promote sustainable soil
management.</p>
<p>From 2021 onwards, soil scientists, agronomy researchers, farm
advisors and extension service providers collaborated to expand the OSI
approach to include multiple ecosystem services. Where the OSI strongly
focuses on the interpretion of soil health in view of crop production,
many other ecosystem services are recognized as crucial societal
objectives that soil can contribute.Relevant soil ecosystem services
from the Sustainable Development Goals (SDGs) include not only delivery
of healthy food (SDG2 and SDG3) but also clean and sufficient water
(SDG6), the mitigation of climate (SDG13), and the support for
biodiversity and protection of land degradation (SDG15). Engaging
farmers to consider these SDGs requires extension of the framework to
include more environmental soil functions.</p>
<p>The newly developed framework follows the conceptual approach of the
OSI and expands the soil health assessment in view of these ecosystem
services. A full description is given in the (Dutch) report <a href="https://edepot.wur.nl/634579" class="external-link"><code>Bodemindicatoren Landbouwgronden in Nederland</code></a>,
and implemented in this BLN R package. This tutorial gives a short
explanation of the package focussing on the main functionalities of the
R package.</p>
</div>
<div class="section level2">
<h2 id="importing-dataset-for-research-farm">Importing dataset for research farm<a class="anchor" aria-label="anchor" href="#importing-dataset-for-research-farm"></a>
</h2>
<p>We start with some (virtual) data being collected for one of the
research farms in the Netherlands: de Marke. This husbandry farm is
located in the Eastern part of the Netherlands, characterised by drought
sensitive sandy soils, and the main land use is grassland and maize.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the data for de Mare farm</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="fu">BLN</span><span class="fu">::</span><span class="va"><a href="../reference/bln_farm_hf.html">bln_farm_hf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a spatial object from the farm, only latest year</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">s1</span><span class="op">[</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span>,<span class="fu">.</span><span class="op">(</span><span class="va">id</span>,<span class="va">geom</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show the first line with all properties for a single field and latest year</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">s1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">geom_sf</span><span class="op">(</span>color<span class="op">=</span><span class="st">'black'</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'fields of the Marke farm'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">coord_sf</span><span class="op">(</span>crs<span class="op">=</span><span class="fl">28992</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="bln_intro_files/figure-html/make-plot-1.png" width="652.8" style="display: block; margin: auto;"></p>
<p><br></p>
<p>The dataset contains soil properties from 29 agricultural fields and
is documented in <code><a href="../reference/bln_farm_hf.html">?bln_farm_hf</a></code>. An overview of all variables
is given below. When interested, look to the <code>summary</code> of the
<code>bln_farm_hf</code> object.</p>
<p>More information on the input and ouput variables are documented in a
separate vignette <code><a href="../articles/bln_column_description.html">vignette("bln_column_description")</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the data for de Mare farm</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="fu">BLN</span><span class="fu">::</span><span class="va"><a href="../reference/bln_farm_hf.html">bln_farm_hf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove unique field identifier (for visual clarity)</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">ref_id_2022</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># show the first line with all properties for a single field and latest year</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "B_LU_BRP"              "id"                    "geom"                 </span></span>
<span><span class="co">#&gt;  [4] "year"                  "A_P_AL"                "A_P_CC"               </span></span>
<span><span class="co">#&gt;  [7] "A_SOM_LOI"             "A_P_WA"                "A_P_SG"               </span></span>
<span><span class="co">#&gt; [10] "A_N_PMN"               "A_PH_CC"               "A_CLAY_MI"            </span></span>
<span><span class="co">#&gt; [13] "A_N_RT"                "A_P_OX"                "A_AL_OX"              </span></span>
<span><span class="co">#&gt; [16] "A_FE_OX"               "A_S_RT"                "A_CN_FR"              </span></span>
<span><span class="co">#&gt; [19] "A_CEC_CO"              "A_SILT_MI"             "A_SAND_MI"            </span></span>
<span><span class="co">#&gt; [22] "A_MG_CC"               "A_K_CC"                "A_P_RT"               </span></span>
<span><span class="co">#&gt; [25] "A_ZN_CC"               "A_CU_CC"               "A_MN_CC"              </span></span>
<span><span class="co">#&gt; [28] "A_CACO3_IF"            "A_K_CO"                "A_CA_CO"              </span></span>
<span><span class="co">#&gt; [31] "A_MG_CO"               "A_CA_CO_PO"            "A_MG_CO_PO"           </span></span>
<span><span class="co">#&gt; [34] "A_K_CO_PO"             "A_K_KG"                "A_K_HCL"              </span></span>
<span><span class="co">#&gt; [37] "A_NA_CO"               "A_NA_CO_PO"            "A_NA_CC"              </span></span>
<span><span class="co">#&gt; [40] "A_CU_HNO3"             "A_CO_CC"               "A_CO_AA"              </span></span>
<span><span class="co">#&gt; [43] "A_B_HW"                "A_B_CC"                "A_NA_HCL"             </span></span>
<span><span class="co">#&gt; [46] "A_MO_CC"               "A_SE_CC"               "A_FE_CC"              </span></span>
<span><span class="co">#&gt; [49] "B_SOILTYPE_AGR"        "B_DRAIN"               "B_SLOPE_DEGREE"       </span></span>
<span><span class="co">#&gt; [52] "own"                   "owp"                   "gw"                   </span></span>
<span><span class="co">#&gt; [55] "B_AER_CBS"             "B_HELP_WENR"           "B_SC_WENR"            </span></span>
<span><span class="co">#&gt; [58] "B_GWL_CLASS"           "a_som_loi_csat_bau"    "a_som_loi_csat_top"   </span></span>
<span><span class="co">#&gt; [61] "d_cs_bau"              "d_cs_top"              "B_GWL_GHG"            </span></span>
<span><span class="co">#&gt; [64] "B_GWL_GLG"             "B_GWL_ZCRIT"           "B_GWP"                </span></span>
<span><span class="co">#&gt; [67] "B_CT_PSW"              "B_CT_NSW"              "B_LSW_ID"             </span></span>
<span><span class="co">#&gt; [70] "D_RO_R"                "D_SA_W"                "B_AREA_DROUGHT"       </span></span>
<span><span class="co">#&gt; [73] "B_FERT_NORM_FR"        "B_LU_WATERSTRESS_OBIC" "B_LU_BBWP"            </span></span>
<span><span class="co">#&gt; [76] "B_LU_CULTCAT4"         "B_LU_SEASON"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-bln-for-a-single-field">calculate BLN for a single field<a class="anchor" aria-label="anchor" href="#calculate-bln-for-a-single-field"></a>
</h2>
<p>Lets see how to assess the soil quality for a single field. First
select the first field given a crop rotation scheme for 11 years. This
is basically a subset of the farm and contains all soil and field
properties for the last 11 years, from 2012 up to 2022. We subsequently
use the function <code><a href="../reference/bln_field.html">bln_field()</a></code> to calculate the different
soil indicators and soil scores. Note that here all the possible inputs
are given whereas all the visual soil assessment observations (ending
with “_bsc”) and the management information are not required for the
current BLN calculation. These are therefore by default set to NA.</p>
<p>We start with a request for the soil indicators.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the data for the first field of de Marke farm</span></span>
<span><span class="va">dt.field</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># calculate the BLN indicator values for that field</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">BLN</span><span class="fu">::</span><span class="fu"><a href="../reference/bln_field.html">bln_field</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">id</span>,</span>
<span>                  B_LU_BRP <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_LU_BRP</span>,</span>
<span>                  B_SC_WENR <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_SC_WENR</span>,</span>
<span>                  B_GWL_CLASS <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_GWL_CLASS</span>,</span>
<span>                  B_SOILTYPE_AGR <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_SOILTYPE_AGR</span>,</span>
<span>                  B_HELP_WENR <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_HELP_WENR</span>,</span>
<span>                  B_AER_CBS <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_AER_CBS</span>,</span>
<span>                  B_GWL_GLG <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_GWL_GLG</span>,</span>
<span>                  B_GWL_GHG <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_GWL_GHG</span>,</span>
<span>                  B_GWL_ZCRIT <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_GWL_ZCRIT</span>,</span>
<span>                  B_DRAIN <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_DRAIN</span>,</span>
<span>                  B_FERT_NORM_FR <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_FERT_NORM_FR</span>,</span>
<span>                  B_SLOPE_DEGREE <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_SLOPE_DEGREE</span>,</span>
<span>                  B_GWP <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_GWP</span>,</span>
<span>                  B_AREA_DROUGHT <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_AREA_DROUGHT</span>,</span>
<span>                  B_CT_PSW <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_CT_PSW</span>,</span>
<span>                  B_CT_NSW <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">B_CT_NSW</span>,</span>
<span>                  B_CT_PSW_MAX <span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                  B_CT_NSW_MAX <span class="op">=</span> <span class="fl">5.0</span>,</span>
<span>                  B_SOMERS_BC <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>                  B_DRAIN_SP <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>                  B_DRAIN_WP <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>                  A_SOM_LOI <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_SOM_LOI</span>,</span>
<span>                  A_SOM_LOI_MLMAX <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">a_som_loi_csat_top</span>,</span>
<span>                  A_CLAY_MI <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_CLAY_MI</span>,</span>
<span>                  A_SAND_MI <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_SAND_MI</span>,</span>
<span>                  A_SILT_MI <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_SILT_MI</span>,</span>
<span>                  A_DENSITY_SA <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>                  A_FE_OX <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_FE_OX</span>,</span>
<span>                  A_AL_OX <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_AL_OX</span>,</span>
<span>                  A_PH_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_PH_CC</span>,</span>
<span>                  A_N_RT <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_N_RT</span>,</span>
<span>                  A_CN_FR <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_CN_FR</span>,</span>
<span>                  A_S_RT <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_S_RT</span>,</span>
<span>                  A_N_PMN <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_N_PMN</span>,</span>
<span>                  A_P_AL <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_P_AL</span>,</span>
<span>                  A_P_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_P_CC</span>,</span>
<span>                  A_P_WA <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_P_WA</span>,</span>
<span>                  A_P_SG <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_P_SG</span>,</span>
<span>                  A_CEC_CO <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_CEC_CO</span>,</span>
<span>                  A_CA_CO_PO <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_CA_CO_PO</span>,</span>
<span>                  A_MG_CO_PO <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_MG_CO_PO</span>,</span>
<span>                  A_K_CO_PO <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_K_CO_PO</span>,</span>
<span>                  A_K_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_K_CC</span>,</span>
<span>                  A_MG_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_MG_CC</span>,</span>
<span>                  A_MN_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_MN_CC</span>,</span>
<span>                  A_ZN_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_ZN_CC</span>,</span>
<span>                  A_CU_CC <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">A_CU_CC</span>,</span>
<span>                  A_EW_BCS <span class="op">=</span> <span class="cn">NA</span>,A_SC_BCS <span class="op">=</span> <span class="cn">NA</span>,A_GS_BCS <span class="op">=</span> <span class="cn">NA</span>,A_P_BCS <span class="op">=</span> <span class="cn">NA</span>,A_C_BCS <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  A_RT_BCS <span class="op">=</span> <span class="cn">NA</span>,A_RD_BCS <span class="op">=</span> <span class="cn">NA</span>,A_SS_BCS <span class="op">=</span> <span class="cn">NA</span>,A_CC_BCS <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  D_SA_W <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">D_SA_W</span>,</span>
<span>                  D_RO_R <span class="op">=</span> <span class="va">dt.field</span><span class="op">$</span><span class="va">D_RO_R</span>,</span>
<span>                  M_COMPOST <span class="op">=</span> <span class="cn">NA_real_</span>,M_GREEN <span class="op">=</span> <span class="cn">NA</span>,M_NONBARE <span class="op">=</span> <span class="cn">NA</span>,M_EARLYCROP <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  M_SLEEPHOSE <span class="op">=</span> <span class="cn">NA</span>,M_DRAIN <span class="op">=</span> <span class="cn">NA</span>,M_DITCH <span class="op">=</span> <span class="cn">NA</span>,M_UNDERSEED <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  M_LIME <span class="op">=</span> <span class="cn">NA</span>,M_NONINVTILL <span class="op">=</span> <span class="cn">NA</span>,M_SSPM <span class="op">=</span> <span class="cn">NA</span>,M_SOLIDMANURE <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  M_STRAWRESIDUE <span class="op">=</span> <span class="cn">NA</span>,M_MECHWEEDS <span class="op">=</span> <span class="cn">NA</span>,M_PESTICIDES_DST <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  B_LSW_ID <span class="op">=</span> <span class="cn">NA_character_</span>,LSW <span class="op">=</span> <span class="cn">NULL</span>, output <span class="op">=</span><span class="st">'indicators'</span>,</span>
<span>                  runrothc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  mc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show the first line with all properties for a single field and latest year</span></span>
<span></span>
<span>  <span class="co"># format in a long table, and subset the numeric columns only</span></span>
<span>  <span class="va">dt2</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">year</span><span class="op">==</span><span class="fl">2022</span><span class="op">]</span><span class="op">[</span>,<span class="va">geom</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># select numeric values and round to two digits</span></span>
<span>  <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'A_|a_|d_|D_|B_CT|B_GWL_G|DEGRE|B_GWL_Z'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,.SDcols <span class="op">=</span> <span class="va">cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># melt the data.table</span></span>
<span>  <span class="va">dt.melt1</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span>,<span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span>,</span>
<span>                  variable.name <span class="op">=</span> <span class="st">'parameter'</span>, value.name <span class="op">=</span> <span class="st">'value'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># print the table</span></span>
<span>  <span class="co"># knitr::kable(dt.melt1,caption='numerical input variables for BLN')</span></span>
<span>  </span>
<span>  <span class="co"># print the table in nicer format</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dt.melt1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">28</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">29</span><span class="op">:</span><span class="fl">42</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">43</span><span class="op">:</span><span class="fl">56</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     caption <span class="op">=</span> <span class="st">'numerical input variables for BLN.'</span>,</span>
<span>     booktabs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper">
<caption>
numerical input variables for BLN.
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_P_AL</td>
<td align="right">58.78</td>
</tr>
<tr class="even">
<td align="left">A_P_CC</td>
<td align="right">2.61</td>
</tr>
<tr class="odd">
<td align="left">A_SOM_LOI</td>
<td align="right">8.69</td>
</tr>
<tr class="even">
<td align="left">A_P_WA</td>
<td align="right">56.70</td>
</tr>
<tr class="odd">
<td align="left">A_P_SG</td>
<td align="right">20.83</td>
</tr>
<tr class="even">
<td align="left">A_N_PMN</td>
<td align="right">49.56</td>
</tr>
<tr class="odd">
<td align="left">A_PH_CC</td>
<td align="right">5.51</td>
</tr>
<tr class="even">
<td align="left">A_CLAY_MI</td>
<td align="right">2.06</td>
</tr>
<tr class="odd">
<td align="left">A_N_RT</td>
<td align="right">1671.13</td>
</tr>
<tr class="even">
<td align="left">A_P_OX</td>
<td align="right">18.40</td>
</tr>
<tr class="odd">
<td align="left">A_AL_OX</td>
<td align="right">35.94</td>
</tr>
<tr class="even">
<td align="left">A_FE_OX</td>
<td align="right">37.15</td>
</tr>
<tr class="odd">
<td align="left">A_S_RT</td>
<td align="right">300.99</td>
</tr>
<tr class="even">
<td align="left">A_CN_FR</td>
<td align="right">15.10</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_CEC_CO</td>
<td align="right">62.63</td>
</tr>
<tr class="even">
<td align="left">A_SILT_MI</td>
<td align="right">13.60</td>
</tr>
<tr class="odd">
<td align="left">A_SAND_MI</td>
<td align="right">84.34</td>
</tr>
<tr class="even">
<td align="left">A_MG_CC</td>
<td align="right">116.25</td>
</tr>
<tr class="odd">
<td align="left">A_K_CC</td>
<td align="right">68.96</td>
</tr>
<tr class="even">
<td align="left">A_P_RT</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">A_ZN_CC</td>
<td align="right">979.67</td>
</tr>
<tr class="even">
<td align="left">A_CU_CC</td>
<td align="right">38.28</td>
</tr>
<tr class="odd">
<td align="left">A_MN_CC</td>
<td align="right">600.46</td>
</tr>
<tr class="even">
<td align="left">A_CACO3_IF</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="left">A_K_CO</td>
<td align="right">2.79</td>
</tr>
<tr class="even">
<td align="left">A_CA_CO</td>
<td align="right">41.09</td>
</tr>
<tr class="odd">
<td align="left">A_MG_CO</td>
<td align="right">9.48</td>
</tr>
<tr class="even">
<td align="left">A_CA_CO_PO</td>
<td align="right">65.60</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_MG_CO_PO</td>
<td align="right">15.13</td>
</tr>
<tr class="even">
<td align="left">A_K_CO_PO</td>
<td align="right">4.45</td>
</tr>
<tr class="odd">
<td align="left">A_K_KG</td>
<td align="right">21.00</td>
</tr>
<tr class="even">
<td align="left">A_K_HCL</td>
<td align="right">12.40</td>
</tr>
<tr class="odd">
<td align="left">A_NA_CO</td>
<td align="right">0.57</td>
</tr>
<tr class="even">
<td align="left">A_NA_CO_PO</td>
<td align="right">1.12</td>
</tr>
<tr class="odd">
<td align="left">A_NA_CC</td>
<td align="right">10.92</td>
</tr>
<tr class="even">
<td align="left">A_CU_HNO3</td>
<td align="right">9.40</td>
</tr>
<tr class="odd">
<td align="left">A_CO_CC</td>
<td align="right">13.54</td>
</tr>
<tr class="even">
<td align="left">A_CO_AA</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">A_B_HW</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">A_B_CC</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">A_NA_HCL</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">A_MO_CC</td>
<td align="right">4.02</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_SE_CC</td>
<td align="right">2.93</td>
</tr>
<tr class="even">
<td align="left">A_FE_CC</td>
<td align="right">3030.00</td>
</tr>
<tr class="odd">
<td align="left">B_SLOPE_DEGREE</td>
<td align="right">0.60</td>
</tr>
<tr class="even">
<td align="left">a_som_loi_csat_bau</td>
<td align="right">3.82</td>
</tr>
<tr class="odd">
<td align="left">a_som_loi_csat_top</td>
<td align="right">6.45</td>
</tr>
<tr class="even">
<td align="left">d_cs_bau</td>
<td align="right">75.47</td>
</tr>
<tr class="odd">
<td align="left">d_cs_top</td>
<td align="right">117.05</td>
</tr>
<tr class="even">
<td align="left">B_GWL_GHG</td>
<td align="right">153.11</td>
</tr>
<tr class="odd">
<td align="left">B_GWL_GLG</td>
<td align="right">242.10</td>
</tr>
<tr class="even">
<td align="left">B_GWL_ZCRIT</td>
<td align="right">99.09</td>
</tr>
<tr class="odd">
<td align="left">B_CT_PSW</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">B_CT_NSW</td>
<td align="right">2.50</td>
</tr>
<tr class="odd">
<td align="left">D_RO_R</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">D_SA_W</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span><span class="co"># do the same for the categorial values</span></span>
<span>  </span>
<span>  <span class="co"># format in a long table, and subset the numeric columns only</span></span>
<span>  <span class="va">dt3</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">year</span><span class="op">==</span><span class="fl">2022</span><span class="op">]</span><span class="op">[</span>,<span class="va">geom</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># select categorial variables</span></span>
<span>  <span class="va">cols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt3</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt3</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">cols</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># convert to chracter</span></span>
<span>  <span class="va">dt3</span> <span class="op">&lt;-</span> <span class="va">dt3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="va">as.character</span><span class="op">)</span>,.SDcols <span class="op">=</span> <span class="va">cols2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># melt the data.table</span></span>
<span>  <span class="va">dt.melt2</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols2</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span>,</span>
<span>                  variable.name <span class="op">=</span> <span class="st">'parameter'</span>, value.name <span class="op">=</span> <span class="st">'value'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># print the table</span></span>
<span>  <span class="co"># knitr::kable(dt.melt2,caption='categorial input variables for BLN')</span></span>
<span></span>
<span>  <span class="co"># print the table in nicer format</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dt.melt2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt2</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">18</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     caption <span class="op">=</span> <span class="st">'categorial input variables for BLN.'</span>,</span>
<span>     booktabs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper">
<caption>
categorial input variables for BLN.
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">B_LU_BRP</td>
<td align="left">266</td>
</tr>
<tr class="even">
<td align="left">B_SOILTYPE_AGR</td>
<td align="left">dekzand</td>
</tr>
<tr class="odd">
<td align="left">B_DRAIN</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">own</td>
<td align="left">0-25%</td>
</tr>
<tr class="odd">
<td align="left">owp</td>
<td align="left">0-25%</td>
</tr>
<tr class="even">
<td align="left">gw</td>
<td align="left">Slecht</td>
</tr>
<tr class="odd">
<td align="left">B_AER_CBS</td>
<td align="left">LG04</td>
</tr>
<tr class="even">
<td align="left">B_HELP_WENR</td>
<td align="left">tZd21</td>
</tr>
<tr class="odd">
<td align="left">B_SC_WENR</td>
<td align="left">4</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">B_GWL_CLASS</td>
<td align="left">GtVII</td>
</tr>
<tr class="even">
<td align="left">B_GWP</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">B_LSW_ID</td>
<td align="left">432</td>
</tr>
<tr class="even">
<td align="left">B_FERT_NORM_FR</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">B_LU_WATERSTRESS_OBIC</td>
<td align="left">grasland met herinzaai</td>
</tr>
<tr class="even">
<td align="left">B_LU_BBWP</td>
<td align="left">gras_tijdelijk</td>
</tr>
<tr class="odd">
<td align="left">B_LU_CULTCAT4</td>
<td align="left">grasland</td>
</tr>
<tr class="even">
<td align="left">B_LU_SEASON</td>
<td align="left">beweid bemaaid gras</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>To simplify, one can also use a data.table as input. In that case use
the function <code><a href="../reference/bln_field_dt.html">bln_field_dt()</a></code>. The function checks whether
all desired input variables are present. By default is the option to
calculate the C saturation with RothC switched off. Again, the
illustration below shows the use of <code>bln_field_dt</code> to
retreive the BLN indicators. For the interpretation of each of the 35
soil indicators, one can have a look at the
<code><a href="../articles/bln_column_description.html">vignette("bln_column_description")</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># select the data for de Marke farm</span></span>
<span><span class="va">dt.field</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># add a few variables to de Marke farm (needs an update)</span></span>
<span><span class="va">dt.field</span><span class="op">[</span>,<span class="va">ID</span> <span class="op">:=</span> <span class="va">id</span><span class="op">]</span></span>
<span><span class="va">dt.field</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_SOMERS_BC"</span>,<span class="st">"B_DRAIN_SP"</span>,<span class="st">"B_DRAIN_WP"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NA_real_</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># calculate the BLN indicator values excluding RothC and LSW = NULL</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bln_field_dt.html">bln_field_dt</a></span><span class="op">(</span><span class="va">dt.field</span>, output <span class="op">=</span> <span class="st">'indicators'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the BLN indicator values including RothC and associated LSW table</span></span>
<span><span class="co"># out &lt;- bln_field_dt(dt.field, LSW = BLN::bln_lsw_farm_hf,output = 'indicators', runrothc = TRUE)</span></span>
<span></span>
<span><span class="co"># print the names of the output object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ID"          "i_b_di"      "i_b_sf"      "i_c_k"       "i_c_mg"     </span></span>
<span><span class="co">#&gt;  [6] "i_c_n"       "i_c_p"       "i_c_ph"      "i_c_s"       "i_clim_csat"</span></span>
<span><span class="co">#&gt; [11] "i_clim_osb"  "i_gw_gwr"    "i_gw_ngw"    "i_gw_nlea"   "i_gw_nret"  </span></span>
<span><span class="co">#&gt; [16] "i_gw_pest"   "i_gw_wb"     "i_nut_k"     "i_nut_n"     "i_nut_nue"  </span></span>
<span><span class="co">#&gt; [21] "i_nut_p"     "i_p_as"      "i_p_co"      "i_p_cr"      "i_p_ds"     </span></span>
<span><span class="co">#&gt; [26] "i_p_du"      "i_p_ro"      "i_p_se"      "i_p_whc"     "i_p_wo"     </span></span>
<span><span class="co">#&gt; [31] "i_p_ws"      "i_sw_nret"   "i_sw_nro"    "i_sw_nsw"    "i_sw_psw"</span></span></code></pre></div>
<p>To ask for the BLN scores, summarizing the contribution of the soil
to various ecosystem services, one can ask for the scores as output.
Just replace the argument output with <code>scores</code> rather than
<code>indicators</code>. It is also possible to ask for both: just set
the argument output equal to <code>all</code>, being the default
option.</p>
<p>Below we summarize the BLN score for a single field. Given the
hierarchical structure of the BLN soil quality assesment, the following
scores are calculated:</p>
<ul>
<li>BLN total score represents the overall integrated soil quality
assessment, where the score varies from zero (serious bottlenecks being
present) up to one (the quality is optimal for the crop rotation plan on
this field)</li>
<li>ESD crop production: the quality score reflecting the ability of the
soil to sustain crop production</li>
<li>ESD climate mitigation: the quality score reflecting the ability of
the soil to store carbon in soil and mitigate climate change</li>
<li>ESD nutrient cycling: the quality score reflecting the ability of
the soil to recycle (regional) nutrients efficiently</li>
<li>ESD water: the quality score reflecting the ability of the soil to
retain and purify water leaching to ground and surface water</li>
</ul>
<p>Besides these four ecoystem services provided by the soil, two of the
ESS can be shown in more detail, thereby reflecting underlying processes
controlling the ESS. First, the ESS crop production can be separated
into the soil quality assessment in view of chemical, physical and
biological soil functions contributing to the ability of soils to
sustain crop production. Second, the ESS water involves a separate
assessment of the capacity of soils to retain and recharge groundwater,
and to purify the water leaching to surface water on the one hand and to
groundwater to the other.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># calculate the BLN indicator and scoring values also without RothC calculations (not run)</span></span>
<span><span class="co"># out &lt;- bln_field_dt(dt.field, output = 'all', runrothc = FALSE)</span></span>
<span></span>
<span><span class="co"># calculate the BLN scoring values for ecosystem services, without using RothC</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bln_field_dt.html">bln_field_dt</a></span><span class="op">(</span><span class="va">dt.field</span>, output <span class="op">=</span> <span class="st">'scores'</span><span class="op">)</span></span>
<span> </span>
<span><span class="co"># reformat the output in a long table</span></span>
<span><span class="va">out.melt</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">out</span>,id.vars<span class="op">=</span><span class="st">'ID'</span>,variable.name<span class="op">=</span><span class="st">'soil_ESD'</span>,value.name<span class="op">=</span><span class="st">'shi'</span><span class="op">)</span></span>
<span><span class="va">out.melt</span> <span class="op">&lt;-</span> <span class="va">out.melt</span><span class="op">[</span><span class="op">!</span><span class="va">soil_ESD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'s_bln_clim'</span>,<span class="st">'s_bln_nut'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># set levels for the soil_ESD with a new label for the figure</span></span>
<span><span class="va">plevel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'s_bln_gw_quality'</span>,<span class="st">'s_bln_gw_quantity'</span>,<span class="st">'s_bln_sw_quality'</span>,<span class="st">'s_bln_esd_water'</span>,</span>
<span>           <span class="st">'s_bln_esd_nut'</span>,<span class="st">'s_bln_esd_clim'</span>,</span>
<span>           <span class="st">'s_bln_prod_b'</span>,<span class="st">'s_bln_prod_p'</span>,<span class="st">'s_bln_prod_c'</span>,<span class="st">'s_bln_esd_prod'</span>, <span class="st">'s_bln_total'</span><span class="op">)</span></span>
<span><span class="va">tlabel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'groundwater quality'</span>,<span class="st">'groundwater quantity'</span>,</span>
<span>           <span class="st">'surfacewater quality'</span>,<span class="st">'ESS water'</span>,</span>
<span>           <span class="st">'ESS nutrient cycling'</span>,<span class="st">'ESS climate mitigation'</span>,</span>
<span>           <span class="st">'crop production biology'</span>,<span class="st">'crop production physics'</span>,</span>
<span>           <span class="st">'crop production chemistry'</span>,<span class="st">'ESS crop production'</span>,</span>
<span>           <span class="st">'BLN total score'</span><span class="op">)</span></span>
<span><span class="va">out.melt</span><span class="op">[</span>,<span class="va">tsoil_ESD</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">soil_ESD</span>,levels <span class="op">=</span> <span class="va">plevel</span>,labels <span class="op">=</span> <span class="va">tlabel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># print the output object</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">out.melt</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">ID</span>,ESS <span class="op">=</span> <span class="va">soil_ESD</span>,description<span class="op">=</span><span class="va">tsoil_ESD</span>,score <span class="op">=</span> <span class="va">shi</span><span class="op">)</span><span class="op">]</span>,</span>
<span>             caption<span class="op">=</span><span class="st">'BLN scores for field 1'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>BLN scores for field 1</caption>
<thead><tr class="header">
<th align="right">ID</th>
<th align="left">ESS</th>
<th align="left">description</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_esd_clim</td>
<td align="left">ESS climate mitigation</td>
<td align="right">0.73</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">s_bln_esd_nut</td>
<td align="left">ESS nutrient cycling</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_esd_prod</td>
<td align="left">ESS crop production</td>
<td align="right">0.79</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">s_bln_esd_water</td>
<td align="left">ESS water</td>
<td align="right">0.46</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_prod_b</td>
<td align="left">crop production biology</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">s_bln_prod_c</td>
<td align="left">crop production chemistry</td>
<td align="right">0.69</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_gw_quality</td>
<td align="left">groundwater quality</td>
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">s_bln_gw_quantity</td>
<td align="left">groundwater quantity</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_prod_p</td>
<td align="left">crop production physics</td>
<td align="right">0.77</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">s_bln_sw_quality</td>
<td align="left">surfacewater quality</td>
<td align="right">0.77</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">s_bln_total</td>
<td align="left">BLN total score</td>
<td align="right">0.65</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># to show the output in a lollipop figure</span></span>
<span><span class="va">plabel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'groundwater\nquality'</span>,<span class="st">'groundwater\nquantity'</span>,</span>
<span>           <span class="st">'surfacewater\nquality'</span>,<span class="st">'ESS water'</span>,</span>
<span>           <span class="st">'ESS nutrient\ncycling'</span>,<span class="st">'ESS climate\nmitigation'</span>,</span>
<span>           <span class="st">'crop production\nbiology'</span>,<span class="st">'crop production\nphysics'</span>,</span>
<span>           <span class="st">'crop production\nchemistry'</span>,<span class="st">'ESS crop\nproduction'</span>,</span>
<span>           <span class="st">'BLN total score'</span><span class="op">)</span></span>
<span><span class="va">out.melt</span><span class="op">[</span>,<span class="va">psoil_ESD</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">soil_ESD</span>,levels <span class="op">=</span> <span class="va">plevel</span>,labels <span class="op">=</span> <span class="va">plabel</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">out.melt</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span> <span class="va">soil_ESD</span>, y<span class="op">=</span> <span class="va">shi</span><span class="op">*</span><span class="fl">10</span>, group <span class="op">=</span> <span class="va">soil_ESD</span>, color <span class="op">=</span> <span class="va">shi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">'grey'</span>, color <span class="op">=</span> <span class="cn">NA</span>, width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">ylab</span><span class="op">(</span><span class="st">'BLN-score'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">''</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">theme_bw</span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span>,</span>
<span>                          panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          panel.grid.major.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                          panel.grid.minor.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu">scale_color_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">ggtitle</span><span class="op">(</span><span class="st">'BLN soil quality assessment field 1'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="bln_intro_files/figure-html/make-sim3-1.png" width="652.8" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="reading-more">Reading more?<a class="anchor" aria-label="anchor" href="#reading-more"></a>
</h2>
<p>More vignettes will be made available regarding the derivation of all
soil health indicators, the aggregation methods applied, the derivation
of optimum land use given the current soil quality assessments, and the
best management practices to be applied to improve the soil quality. Are
you interested to contribute, please contact the author(s) of this R
package. Enjoy!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gerard Ros, Sven Verweij, Yuki Fujita, Noud van Dam, Brent Riechelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
