<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BLN assessment for crop production • BLN</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BLN assessment for crop production">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BLN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bln_column_description.html">Description of the input and output for BLN</a></li>
    <li><a class="dropdown-item" href="../articles/bln_ess_crop_production.html">BLN assessment for crop production</a></li>
    <li><a class="dropdown-item" href="../articles/bln_intro.html">BLN introduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AgroCares/BLN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>BLN assessment for crop production</h1>
                        <h4 data-toc-skip class="author">Gerard H.
Ros</h4>
            
            <h4 data-toc-skip class="date">2025-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AgroCares/BLN/blob/v0.9.0/vignettes/bln_ess_crop_production.Rmd" class="external-link"><code>vignettes/bln_ess_crop_production.Rmd</code></a></small>
      <div class="d-none name"><code>bln_ess_crop_production.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>Facilitating and promoting crop production is one of the ecosystem
services a soil supplies. The Dutch soil assessment scheme BLN, being an
abbreviation for
<code>Bodemindicatorenset Landbouwgronden Nederland</code>, strongly
depends on the <a href="https://pubs.acs.org/doi/10.1021/acs.est.2c04516#" class="external-link">Open Soil Index
Framework</a>, a presucessor of the BLN. The Open Soil Index is
currently in use by farmers and farm advisors to facilitate sustainable
soil management. In addition, governments, banks, regional governments,
agricultural laboratories and other stakeholders are using this
framework to monitor soil health and valorise appropriate soil
management measures. For more information on the OSI, see: <a href="%5BOBIC%5D">the OBIC package</a>.</p>
</div>
<div class="section level3">
<h3 id="the-soil-assessment-framework">The Soil Assessment Framework<a class="anchor" aria-label="anchor" href="#the-soil-assessment-framework"></a>
</h3>
<p>Soil quality is defined as the capacity of a soil to fulfill the
desired soil functions under varying conditions for a combination of
purposes (and services) such as food production, efficient nutrient
cycling, and preservation of biodiversity. This vignette is focussing on
the ecosystem service food production. Lets start with some
definitions:</p>
<ul>
<li>Soil functions are quantitative relationships evaluating how soil
properties alone or in combination with each other contribute to crop
produciton.</li>
<li>Soil indicators are the result of an evaluation scoring methodology
transforming the output of soil functions to a qualitative category (low
to high) or a numeric grade (1-10).</li>
<li>Soil and field properties are characteristics of a soil (or field)
that are used to quantify the soil functions. These characteristics may
have been analyzed in the laboratory as well as those resulting from the
location of the field in the landscape. For example, the groundwater
level, the variation in ground level, the slope, and the presence of
drainage are soil properties.</li>
<li>Soil management includes all measures that land users or farmers can
take to improve or adapt soil quality for a specific purpose. This has a
direct influence on (measurable) soil properties.</li>
</ul>
<p>Within the boundary condition of context (i.e. continuation of crop
rotation scheme in next decade) and objective (i.e. sustainable crop
production), soil properties are quantified based on routinely available
soil analyses, and field properties. The soil properties are in
conjunction with each other used to quantify a number of soil functions.
These functions can be clustered around the three relevant aspects of
soil, namely:</p>
<ol style="list-style-type: lower-roman">
<li>chemistry and nutrient supply,</li>
<li>structure and rootability and</li>
<li>biology and disease resistance.</li>
</ol>
<p>The algorithms to evaluate and assess the quality of the soil
originates from field experiments and evidence from fundamental as well
as applied research.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="the-bln-calculator">2. The BLN calculator<a class="anchor" aria-label="anchor" href="#the-bln-calculator"></a>
</h2>
<p>The BLN package makes it possible to evaluate Soil Health for a
number of aggregated soil functions, evaluating a series of soil
functions in relation to a “distance to target”.</p>
<div class="section level4">
<h4 id="data-fields-of-the-marke">Data: fields of the Marke<a class="anchor" aria-label="anchor" href="#data-fields-of-the-marke"></a>
</h4>
<p>To explore the functionality of BLN for the ecosystem service crop
produciton, we’ll use the dataset <code>bln_farm_hf</code>. The dataset
contains soil properties from 11 agricultural fields being owned by a
research farm of the Wageningen University and Research, with all
properties being estimated by data from the
<code>National Agricultural Soil Archive</code> of the NMI, and is
documented in <code><a href="../reference/bln_farm_hf.html">?bln_farm_hf</a></code>.</p>
<p>For each field, the following properties are available for a 10 year
period:</p>
<ul>
<li>field properties: ID, landuse (B_LU_BRP) and agricultural region
(B_AER_CBS), and the geometry (geom)</li>
<li>basic soil properties: soil type (B_SOILTYPE_AGR, B_HELP_WENR), risk
for soil compaction (B_SC_WENR) and groundwater level (B_GWL_CLASS)</li>
<li>chemical, physical and biological soil properties obtained from
measurements (all variables starting with “A_”)</li>
<li>measurements done via a Visual Soil Assessment Form (optional, all
variables starting with “A_” and ending with “BCS”). For details, see
the Assessment Form of the <a href="https://mijnbodemconditie.nl/download/" class="external-link">Bodemconditiescore</a>.</li>
</ul>
<p>Below a short snapshot of the <code>bln_farm_hf</code> is given:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="co"># dimensions of the database</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bln_farm_hf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 330  78</span></span>
<span></span>
<span>  <span class="co"># format in a long table, and subset the numeric columns only</span></span>
<span>  <span class="va">dt2</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">bln_farm_hf</span><span class="op">)</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">year</span><span class="op">==</span><span class="fl">2022</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'geom'</span>,<span class="st">'ref_id_2022'</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># select numeric values and round to two digits</span></span>
<span>  <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^A_|a_|d_|D_|B_CT|B_GWL_G|DEGRE|B_GWL_Z'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">dt2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">fifelse</span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu">fifelse</span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">10</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,.SDcols <span class="op">=</span> <span class="va">cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># melt the data.table</span></span>
<span>  <span class="va">dt.melt1</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span>,<span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span>,</span>
<span>                  variable.name <span class="op">=</span> <span class="st">'parameter'</span>, value.name <span class="op">=</span> <span class="st">'value'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># print the table in nice format</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dt.melt1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">28</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">29</span><span class="op">:</span><span class="fl">42</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt1</span><span class="op">[</span><span class="fl">43</span><span class="op">:</span><span class="fl">56</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     caption <span class="op">=</span> <span class="st">'numerical input variables for BLN.'</span>,</span>
<span>     booktabs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper">
<caption>
numerical input variables for BLN.
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_P_AL</td>
<td align="right">59.0</td>
</tr>
<tr class="even">
<td align="left">A_P_CC</td>
<td align="right">2.6</td>
</tr>
<tr class="odd">
<td align="left">A_SOM_LOI</td>
<td align="right">8.7</td>
</tr>
<tr class="even">
<td align="left">A_P_WA</td>
<td align="right">57.0</td>
</tr>
<tr class="odd">
<td align="left">A_P_SG</td>
<td align="right">21.0</td>
</tr>
<tr class="even">
<td align="left">A_N_PMN</td>
<td align="right">50.0</td>
</tr>
<tr class="odd">
<td align="left">A_PH_CC</td>
<td align="right">5.5</td>
</tr>
<tr class="even">
<td align="left">A_CLAY_MI</td>
<td align="right">2.1</td>
</tr>
<tr class="odd">
<td align="left">A_N_RT</td>
<td align="right">1671.0</td>
</tr>
<tr class="even">
<td align="left">A_P_OX</td>
<td align="right">18.0</td>
</tr>
<tr class="odd">
<td align="left">A_AL_OX</td>
<td align="right">36.0</td>
</tr>
<tr class="even">
<td align="left">A_FE_OX</td>
<td align="right">37.0</td>
</tr>
<tr class="odd">
<td align="left">A_S_RT</td>
<td align="right">301.0</td>
</tr>
<tr class="even">
<td align="left">A_CN_FR</td>
<td align="right">15.0</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_CEC_CO</td>
<td align="right">63.00</td>
</tr>
<tr class="even">
<td align="left">A_SILT_MI</td>
<td align="right">14.00</td>
</tr>
<tr class="odd">
<td align="left">A_SAND_MI</td>
<td align="right">84.00</td>
</tr>
<tr class="even">
<td align="left">A_MG_CC</td>
<td align="right">116.00</td>
</tr>
<tr class="odd">
<td align="left">A_K_CC</td>
<td align="right">69.00</td>
</tr>
<tr class="even">
<td align="left">A_P_RT</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">A_ZN_CC</td>
<td align="right">980.00</td>
</tr>
<tr class="even">
<td align="left">A_CU_CC</td>
<td align="right">38.00</td>
</tr>
<tr class="odd">
<td align="left">A_MN_CC</td>
<td align="right">600.00</td>
</tr>
<tr class="even">
<td align="left">A_CACO3_IF</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="left">A_K_CO</td>
<td align="right">2.80</td>
</tr>
<tr class="even">
<td align="left">A_CA_CO</td>
<td align="right">41.00</td>
</tr>
<tr class="odd">
<td align="left">A_MG_CO</td>
<td align="right">9.50</td>
</tr>
<tr class="even">
<td align="left">A_CA_CO_PO</td>
<td align="right">66.00</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_MG_CO_PO</td>
<td align="right">15.00</td>
</tr>
<tr class="even">
<td align="left">A_K_CO_PO</td>
<td align="right">4.50</td>
</tr>
<tr class="odd">
<td align="left">A_K_KG</td>
<td align="right">21.00</td>
</tr>
<tr class="even">
<td align="left">A_K_HCL</td>
<td align="right">12.00</td>
</tr>
<tr class="odd">
<td align="left">A_NA_CO</td>
<td align="right">0.57</td>
</tr>
<tr class="even">
<td align="left">A_NA_CO_PO</td>
<td align="right">1.10</td>
</tr>
<tr class="odd">
<td align="left">A_NA_CC</td>
<td align="right">11.00</td>
</tr>
<tr class="even">
<td align="left">A_CU_HNO3</td>
<td align="right">9.40</td>
</tr>
<tr class="odd">
<td align="left">A_CO_CC</td>
<td align="right">14.00</td>
</tr>
<tr class="even">
<td align="left">A_CO_AA</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">A_B_HW</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">A_B_CC</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">A_NA_HCL</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">A_MO_CC</td>
<td align="right">4.00</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_SE_CC</td>
<td align="right">2.9</td>
</tr>
<tr class="even">
<td align="left">A_FE_CC</td>
<td align="right">3030.0</td>
</tr>
<tr class="odd">
<td align="left">B_SLOPE_DEGREE</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">a_som_loi_csat_bau</td>
<td align="right">3.8</td>
</tr>
<tr class="odd">
<td align="left">a_som_loi_csat_top</td>
<td align="right">6.4</td>
</tr>
<tr class="even">
<td align="left">d_cs_bau</td>
<td align="right">75.0</td>
</tr>
<tr class="odd">
<td align="left">d_cs_top</td>
<td align="right">117.0</td>
</tr>
<tr class="even">
<td align="left">B_GWL_GHG</td>
<td align="right">153.0</td>
</tr>
<tr class="odd">
<td align="left">B_GWL_GLG</td>
<td align="right">242.0</td>
</tr>
<tr class="even">
<td align="left">B_GWL_ZCRIT</td>
<td align="right">99.0</td>
</tr>
<tr class="odd">
<td align="left">B_CT_PSW</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">B_CT_NSW</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="left">D_RO_R</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">D_SA_W</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span><span class="co"># do the same for the categorial values</span></span>
<span>  </span>
<span>  <span class="co"># format in a long table, and subset the numeric columns only</span></span>
<span>  <span class="va">dt3</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">bln_farm_hf</span><span class="op">)</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">year</span><span class="op">==</span><span class="fl">2022</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'geom'</span>,<span class="st">'ref_id_2022'</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># select categorial variables</span></span>
<span>  <span class="va">cols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt3</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dt3</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">cols</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># convert to chracter</span></span>
<span>  <span class="va">dt3</span> <span class="op">&lt;-</span> <span class="va">dt3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="va">as.character</span><span class="op">)</span>,.SDcols <span class="op">=</span> <span class="va">cols2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># melt the data.table</span></span>
<span>  <span class="va">dt.melt2</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols2</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span>,<span class="st">'year'</span><span class="op">)</span>,</span>
<span>                  variable.name <span class="op">=</span> <span class="st">'parameter'</span>, value.name <span class="op">=</span> <span class="st">'value'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># print the table in nicer format</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dt.melt2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="va">dt.melt2</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">18</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     caption <span class="op">=</span> <span class="st">'categorial input variables for BLN.'</span>,</span>
<span>     booktabs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper">
<caption>
categorial input variables for BLN.
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">B_LU_BRP</td>
<td align="left">266</td>
</tr>
<tr class="even">
<td align="left">B_SOILTYPE_AGR</td>
<td align="left">dekzand</td>
</tr>
<tr class="odd">
<td align="left">B_DRAIN</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">own</td>
<td align="left">0-25%</td>
</tr>
<tr class="odd">
<td align="left">owp</td>
<td align="left">0-25%</td>
</tr>
<tr class="even">
<td align="left">gw</td>
<td align="left">Slecht</td>
</tr>
<tr class="odd">
<td align="left">B_AER_CBS</td>
<td align="left">LG04</td>
</tr>
<tr class="even">
<td align="left">B_HELP_WENR</td>
<td align="left">tZd21</td>
</tr>
<tr class="odd">
<td align="left">B_SC_WENR</td>
<td align="left">4</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<thead><tr class="header">
<th align="left">parameter</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">B_GWL_CLASS</td>
<td align="left">GtVII</td>
</tr>
<tr class="even">
<td align="left">B_GWP</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">B_LSW_ID</td>
<td align="left">432</td>
</tr>
<tr class="even">
<td align="left">B_AREA_DROUGHT</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">B_FERT_NORM_FR</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">B_LU_WATERSTRESS_OBIC</td>
<td align="left">grasland met herinzaai</td>
</tr>
<tr class="odd">
<td align="left">B_LU_BBWP</td>
<td align="left">gras_tijdelijk</td>
</tr>
<tr class="even">
<td align="left">B_LU_CULTCAT4</td>
<td align="left">grasland</td>
</tr>
<tr class="odd">
<td align="left">B_LU_SEASON</td>
<td align="left">beweid bemaaid gras</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>In this example all optional input variables are set to the lowest
score (for visuals soil assessment). Since soil quality can only be
evaluated given its use, the crop rotation (being the sequence of crops
cultivated over time) determines also which soil properties and which
soil functions are relevant and how they are evaluated given a desired
threshold value.</p>
<p>Note that <code>bln_farm_hf</code> is a data.table, a modern and fast
variant of a data frame [data.table]. It’s particularly useful for large
datasets because it only prints a selection of the dataset and
calculations done on a data.table are extremely fast. You can learn more
about data.tables at <a href="https://CRAN.R-project.org/package=data.table/vignettes/datatable-intro.html" class="external-link">this
link</a> ; in particular you can convert data frames to data.tables with
as.data.table().</p>
</div>
<div class="section level4">
<h4 id="running-bln-for-a-single-field">Running BLN for a single field<a class="anchor" aria-label="anchor" href="#running-bln-for-a-single-field"></a>
</h4>
<p>The main function to evaluate the quality of the soil is
<code><a href="../reference/bln_field.html">bln_field()</a></code> as well as <code><a href="../reference/bln_field_dt.html">bln_field_dt()</a></code>. Both
are wrappers around the the following steps (where the latter requires a
data.table as input and the former does not):</p>
<ul>
<li>Data preparation:
<ul>
<li>check format B_SC_WENR, B_AER_CBS, and B_GWL_CLASS</li>
<li>add default estimates for soil management measures given soil type
and land use</li>
</ul>
</li>
<li>Estimate soil indicators (evaluating soil functions given a distance
to target)
<ul>
<li>soil chemical functions</li>
<li>soil physical functions</li>
<li>soil biological functions</li>
<li>apply corrections when visual soil assessment observations are
given</li>
</ul>
</li>
<li>Aggregate soil indicators over the crop rotation plan</li>
<li>Aggregate soil functions into soil quality scores
<ul>
<li>for soil chemical, physical, and biological soil quality</li>
<li>for benchmarking (not yet implemented)</li>
</ul>
</li>
</ul>
<p>The process how measurable soil properties are used to evaluate the
agronomic soil quality is visualized in Figure 1, copied from the OSI
approach.</p>
<p><br></p>
<div class="figure">
<img src="../reference/figures/OBIC_score_integratie_2.png" alt="Figure 1. Graphic representation of how measured soil properties are aggregated to scores." width="85%" height="85%"><p class="caption">
Figure 1. Graphic representation of how measured soil properties are
aggregated to scores.
</p>
</div>
<p><br></p>
<p>An example of both wrapper functions is illustrated below. The soil
has an BLN score of 0.79 indicating a relatively good quality to
continue the current crop rotation plan. A value of one means that the
soil quality is optimum for the continuation of the cropping plan
whereas a value of zero means that there are substantial bottlenecks
that need to be solved. Note that the BLN is automatically also
calculating scores for other ecosystem services not elaborated in this
vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span>  <span class="co"># select the data for de Mare farm</span></span>
<span>  <span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="fu">BLN</span><span class="fu">::</span><span class="va"><a href="../reference/bln_farm_hf.html">bln_farm_hf</a></span><span class="op">)</span></span>
<span>  <span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># run the bln_field with default management measures and no visual assessment data</span></span>
<span>  <span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bln_field.html">bln_field</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">id</span>,B_LU_BRP <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_LU_BRP</span>,B_SC_WENR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_SC_WENR</span>,</span>
<span>            B_GWL_CLASS <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_CLASS</span>,B_SOILTYPE_AGR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_SOILTYPE_AGR</span>,</span>
<span>            B_HELP_WENR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_HELP_WENR</span>,B_AER_CBS <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_AER_CBS</span>,</span>
<span>            B_GWL_GLG <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_GLG</span>,B_GWL_GHG <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_GHG</span>,</span>
<span>            B_GWL_ZCRIT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWL_ZCRIT</span>,B_DRAIN <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_DRAIN</span>,</span>
<span>            B_FERT_NORM_FR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_FERT_NORM_FR</span>,B_SLOPE_DEGREE <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_SLOPE_DEGREE</span>,</span>
<span>            B_GWP <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_GWP</span>,B_AREA_DROUGHT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_AREA_DROUGHT</span>,</span>
<span>            B_CT_PSW <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_CT_PSW</span>,B_CT_NSW <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">B_CT_NSW</span>,</span>
<span>            B_SOMERS_BC <span class="op">=</span> <span class="cn">NA_real_</span>,B_DRAIN_SP <span class="op">=</span> <span class="cn">NA_real_</span>,B_DRAIN_WP <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>            A_SOM_LOI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SOM_LOI</span>,A_SOM_LOI_MLMAX <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">a_som_loi_csat_top</span>,</span>
<span>            A_CLAY_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CLAY_MI</span>,A_SAND_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SAND_MI</span>,</span>
<span>            A_SILT_MI <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_SILT_MI</span>,A_DENSITY_SA <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>            A_FE_OX <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_FE_OX</span>,A_AL_OX <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_AL_OX</span>,</span>
<span>            A_PH_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_PH_CC</span>,A_N_RT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_N_RT</span>,A_CN_FR <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CN_FR</span>,</span>
<span>            A_S_RT <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_S_RT</span>,A_N_PMN <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_N_PMN</span>,A_P_AL <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_AL</span>,</span>
<span>            A_P_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_CC</span>,A_P_WA <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_WA</span>,A_P_SG <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_P_SG</span>,</span>
<span>            A_CEC_CO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CEC_CO</span>,A_CA_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CA_CO_PO</span>,</span>
<span>            A_MG_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MG_CO_PO</span>,A_K_CO_PO <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_K_CO_PO</span>,</span>
<span>            A_K_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_K_CC</span>,A_MG_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MG_CC</span>,A_MN_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_MN_CC</span>,</span>
<span>            A_ZN_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_ZN_CC</span>,A_CU_CC <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">A_CU_CC</span>, D_SA_W <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">D_SA_W</span>,</span>
<span>            D_RO_R <span class="op">=</span> <span class="va">dt</span><span class="op">$</span><span class="va">D_RO_R</span>, output <span class="op">=</span><span class="st">'scores'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># show output</span></span>
<span>  <span class="va">cols1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'esd_prod|bln_prod'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">o1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">o1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols1</span><span class="op">)</span><span class="op">]</span>,caption<span class="op">=</span><span class="st">'BLN soil quality scores for ESS crop production'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>BLN soil quality scores for ESS crop production</caption>
<thead><tr class="header">
<th align="right">s_bln_esd_prod</th>
<th align="right">s_bln_prod_b</th>
<th align="right">s_bln_prod_c</th>
<th align="right">s_bln_prod_p</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.79</td>
<td align="right">1</td>
<td align="right">0.69</td>
<td align="right">0.77</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span>  <span class="co"># temporary fix: add three variables to bln_farm_hf</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="va">ID</span> <span class="op">:=</span> <span class="va">id</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_SOMERS_BC"</span>,<span class="st">"B_DRAIN_SP"</span>,<span class="st">"B_DRAIN_WP"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NA_real_</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># test the BLN field function via bln_field_dt and give only the final score</span></span>
<span>  <span class="va">o2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bln_field_dt.html">bln_field_dt</a></span><span class="op">(</span><span class="va">dt</span>,output <span class="op">=</span> <span class="st">'scores'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># show output</span></span>
<span>  <span class="va">cols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'esd_prod|bln_prod'</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">o2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">o2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">mget</a></span><span class="op">(</span><span class="va">cols2</span><span class="op">)</span><span class="op">]</span>,caption<span class="op">=</span><span class="st">'BLN soil quality scores for ESS crop production'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>BLN soil quality scores for ESS crop production</caption>
<thead><tr class="header">
<th align="right">s_bln_esd_prod</th>
<th align="right">s_bln_prod_b</th>
<th align="right">s_bln_prod_c</th>
<th align="right">s_bln_prod_p</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.79</td>
<td align="right">1</td>
<td align="right">0.69</td>
<td align="right">0.77</td>
</tr></tbody>
</table>
<p>When interested in the averaged indicator value or the averaged
aggregated soil indicators, one can adjust the <code>output</code>
argument of the wrapper functions.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="the-evaluated-soil-functions">3. The Evaluated Soil Functions<a class="anchor" aria-label="anchor" href="#the-evaluated-soil-functions"></a>
</h2>
<p>To assess the soil quality of an agricultural field, soil properties
are used to derive so-called soil functions. Theses soil functions
represent distinct processes in soil supporting the sustainable crop
development. The soil functions are subsequently evaluated in view of a
given threshold value. In this section the available soil functions are
presented and illustrated.</p>
<div class="section level3">
<h3 id="chemical-soil-functions">3.1. Chemical soil functions<a class="anchor" aria-label="anchor" href="#chemical-soil-functions"></a>
</h3>
<p>The BLN quantifies and evaluates the capacity of the soil to supply
nitrogen, phosphorus, potassium, magnesium, and sulpher as well as the
capacity of the soil to buffer cations and the pH. The functions are
illustrated and explained below.</p>
<div class="section level4">
<h4 id="nitrogen-supplying-capacity">Nitrogen supplying capacity<a class="anchor" aria-label="anchor" href="#nitrogen-supplying-capacity"></a>
</h4>
<p>Nitrogen is the nutrient that plants need most and is often the first
limiting factor for growth. Plants take up nitrogen in mineral form as
nitrate and ammonium. However, nitrogen is largely present in the soil
in organic compounds. The availability of N to plants during the growing
season therefore depends on the extent and rate of mineralization from
the organic matter.</p>
<p>Nitrogen supply on grassland is derived from empirical datasets
relating total N levels in soil to the N supply, depending on sampling
depth, soil texture, and the age of the grassland. For arable fields,
the N supply is derived from a simple first order decomposition model,
calibrated for Dutch circumstances and depending on soil texture,
organic matter, and total N content.</p>
<p>The N supplying capacity is assessed via the BLN function
<code>bln_c_nitrogen</code>. The function requires the following input:
the BRP crop code, the soil type, the organic matter content, the total
N content and the CN ratio of the organic matter. For more information,
see <code><a href="../reference/bln_c_nitrogen.html">?bln_c_nitrogen</a></code>.</p>
<p>An example of this function is illustrated below for a maize and
grassland field (crop code maize is 259, grassland is 266) with varying
levels of total soil N. In summary, the N supplying capacity of a soil
increases with the total N present in the soil. The N supplying capacity
at a given total N level is higher in grassland fields compared to
arable fields.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The total N supply is evaluated via a parabolic scoring function with
an optimum of 100 kg N / ha in arable fields and 140 kg N / ha in
grassland fields.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="phosphorus-availability-index">Phosphorus Availability Index<a class="anchor" aria-label="anchor" href="#phosphorus-availability-index"></a>
</h4>
<p>Phosphate (P) is present in the soil in both inorganic and organic.
Inorganic P present in the soil solution is directly available for plant
uptake. The amount of P in the soil solution is small compared to the
total P supply of the soil. Organic P is only available to the plant
after decomposition by micro-organisms. The undissolved inorganic and
organic P compounds can be divided into labile and stable compounds:</p>
<ul>
<li>The labile P fraction is in equilibrium with the P in solution and
is the main source of P re-supply to the soil solution. Labile inorganic
P compounds include P bound to the surface of iron and aluminium (hydr-)
oxides, and iron (Fe), aluminium (Al) and calcium phosphates. In acid
and neutral soils, P availability is mainly determined by its binding to
Fe and Al (hydr-) oxides. In calcareous soils, P is usually associated
with calcium (Ca).</li>
<li>The stable P compounds are usually poorly soluble and therefore
poorly available to plants. Stable inorganic P compounds include
P-containing soil minerals (e.g. apatite).</li>
</ul>
<p>The phosphorus supply of an agricultural soil can be derived from
methods measuring either a capacity or an intensity of P pools in soil
or a combination of both. The latter approach is followed for grassland
and maize fields, where the optimum P supply is derived from multiple
field experiments across the Netherlands. For arable farming systems,
the phosphorus supply is derived from one measured P pool reflecting the
P status as well as controlling the crop response to P inputs. The
availability is highly controlled by chemical adsorption and desorption
equilibria and affected by the iron and aluminum oxides content of soils
as well as the availability of oxygen. A phosphorus supply around 4.8
(unitless index, for maize and grassland fields) and 45 (mg P2O5 per
liter, for arable fields) is optimal for crop production.</p>
<p>To assess the capacity of soils to supply P, one can make use of the
function <code>bln_c_posphor</code>. The function requires the following
input: the BRP crop code and P concentration measured via extraction of
ammonium lactate (A_P_AL), water (A_P_WA) or 0.01M CaCl2 (A_P_CC).</p>
<p>For more details, see <code><a href="../reference/bln_c_posphor.html">?bln_c_posphor</a></code>.</p>
<p>An example of this function is illustrated below for both an arable
and a grassland field with one levels of A_P_AL (being sufficient for
crop growth) en varying levels of A_P_CC.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="potassium-supply">Potassium supply<a class="anchor" aria-label="anchor" href="#potassium-supply"></a>
</h4>
<p>Like N and P, potassium (K) an important element for crop growth.
Potassium is almost exclusively present in the soil in mineral form. The
amount of K in the soil can be divided into 4 fractions: * K^+- ions in
the soil solution; completely and directly available to the plant, but
insufficient to cover the needs of the crop * K-exchangeable; K adsorbed
to the clay and humus particles (adsorption complex; CEC). The exchange
between K in the soil solution and K adsorbed occurs rapidly: within
minutes to 24 hours * K-fixed or bound (in clay soils); the K enclosed
in the clay plates. Exchange between K-fixed and K-soil solution takes
days to months * K-mineral or K rock; becomes available through
weathering. The amount of K that becomes available through weathering
during a growing season is too small to be of agricultural interest.</p>
<p>The K supply is strongly controlled by the distribution of K over the
possible K pools in soil, being controlled by adsorption and desorption
processes, the cation exchange capacity of the soil and competing ions
in soil solution and present at the exchange complex. Building on
agronomic research from the last decade, the K supply is quantified for
grasslands using the plant available K fraction (measured via
CaCl2-extraction, K-CaCl2) as well as the CEC. For maize it is
quantified using K-CaCl2 and for arable fields its quantified from
K-CaCl2 and the CEC while accounting for the clay content, the organic
matter content and the pH of the soil.</p>
<p>To assess the capacity of soils to supply K, one can make use of the
function <code>bln_c_potassium</code>. The function requires the
following input: the BRP crop code, the soil type, the organic matter
content, the clay content, the pH, the cation exchange capacity (CEC),
the occupation of the CEC with potassium (%) and the directly available
concentration of K as determined with a soil extraction with 0.01M
CaCl2.</p>
<p>For more details, see <code><a href="../reference/bln_c_potassium.html">?bln_c_potassium</a></code>.</p>
<p>An example of this function is illustrated below for both an arable
and a grassland field, with a sandy texture, a fixed CEC and a fixed
occupation of the CEC and a variable plant available K level. Note that
the grassland yield quicker responds to the plant available levels of K
with also a lower target value.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="sulfur-supply">Sulfur supply<a class="anchor" aria-label="anchor" href="#sulfur-supply"></a>
</h4>
<p>Sulfur (S) is needed - along with nitrogen - for the formation of
proteins in the plant. Whether S supply from the soil is sufficient for
optimal production and quality depends on the crop’s S requirements and
the S supply in the soil. The S supply is determined by soil processes
and external sulfur supplies to the soil.</p>
<p>The amount of sulfur in the soil that is available for crop uptake is
determined by the mineral sulfur supply remaining in the soil after
winter (Smin), mineralization of sulfur in the soil during the growing
season (sulfur supply capacity), sulfur deposition, sulfur supply by
irrigation during cultivation, capillary rise of sulfur-containing
groundwater, and by possible losses. Sulfur supply, capillary rise, and
Smin are quantitatively the most important inputs of sulfur. However,
all three can vary considerably. The contribution from sulfur deposition
is only minor throughout the Netherlands. A substantial amount of sulfur
can also be supplied through irrigation with sulfurous spring water.
This supply, however, varies greatly, depending on the amount sprayed
and the sulfur content of the water.</p>
<p>To assess the S supplying capacity of the soil, one can make use of
the function <code>bln_c_sulfur</code>. The function requires the
following input: the BRP crop code, the soil type, the agricultural
region within the Netherlands (used to estimate default S deposition
rates), the organic matter content, and the total S content of the
soil.</p>
<p>For more details, see <code><a href="../reference/bln_c_sulfur.html">?bln_c_sulfur</a></code>.</p>
<p>An example of this function is illustrated below for both an arable
and a grassland field.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="magnesium-supply">Magnesium supply<a class="anchor" aria-label="anchor" href="#magnesium-supply"></a>
</h4>
<p>Magnesium is an important element for crop growth, livestock health,
and livestock productivity. Deficiencies for magnesium often occur on
sandy soils with low organic matter and low pH. The supply of Mg for
arable fields as well as grassland fields on sandy soils is directly
related to the plant available Mg-content (Mg-CaCl2). For grassland
fields on clay and peat soils the Mg-supply is indirectly quantified
given the required composition of the grass (for intake by cows) and
depends on the CEC, the organic matter and clay content, pH, as well as
the K-availability assessed by K-CaCl2 and K-CEC.</p>
<p>To assess the Mg supplying capacity of the soil, one can make use of
the function <code>i_c_mg</code>. The function requires the following
input: the BRP crop code, the soil type, the organic matter content, the
clay content, the pH, the cation exchange capacity (CEC), the occupation
of the CEC with potassium (%) and the directly available concentration
of both Mg and K as determined with a soil extraction with 0.01M
CaCl2.</p>
<p>For more details, see <code>?i_c_mg</code>.</p>
<p>An example of this function is illustrated below for both an arable
and a grassland field.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="soil-acidity">Soil Acidity<a class="anchor" aria-label="anchor" href="#soil-acidity"></a>
</h4>
<p>The pH is a measure of the acidity of the soil. The pH influences the
soil quality and crop growth, among others through availability of
nutrients and (heavy) metals and activity of soil life. In addition, the
pH also influences various soil functions such as nutrient buffering and
aggregate stability. The optimum soil pH for crop growth differs per
crop. Potatoes prefer a lower pH and cereals, maize, sugar beet, and
field vegetables a higher pH. Organic matter reduces the negative effect
of pH on crop growth. On sandy soils with an organic matter content of
15%, the desired pH can be up to half a unit lower than on low organic
matter content soils. On clay soils the desired pH is higher than on
sandy soils. With a clay percentage above 10, the desired pH is half a
unit higher than with low clay percentages.</p>
<p>The optimum pH is determined in historical field experiments given
crop rotation plan, soil texture, soil organic matter, and initial pH.
The assessment of the current soil pH can be done via the function
<code>i_c_ph</code>. The function requires the following input
variables: land use (B_LU_BRP), soil type (B_SOILTYPE_AGR), soil organic
matter (A_SOM_LOI), clay content (A_CLAY_MI) and the pH measured in
CaCl2 (A_PH_CC).</p>
<p>For more details, see <code>?i_c_ph</code>.</p>
<p>An example of this function is illustrated below for both an arable
and a grassland field over a predefined range in initial pH from 3 to
7.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="obic-indicators-not-used">OBIC indicators not used<a class="anchor" aria-label="anchor" href="#obic-indicators-not-used"></a>
</h4>
<p>From the OBIC calculator three indicators reflecting soil chemical
functions are not used in the BLN. These include the availability and
buffering of zinc and copper on the one hand, and the cation exchange
capacity as factor controlling the availability of cations.</p>
</div>
</div>
<div class="section level3">
<h3 id="physical-soil-functions">3.2 Physical soil functions<a class="anchor" aria-label="anchor" href="#physical-soil-functions"></a>
</h3>
<p>The BLN evaluates also a series of physical soil functions related to
the supply of water and the rootability of the top and subsoil. The
different soil physical functions are illustrated and explained below.
Soil physical functions include the capacity of soils to retain and
supply water, to resist wind erosion, topsoil sealing, subsoil
compaction, and to deliver bearing capacity for mechanic activities.</p>
<div class="section level4">
<h4 id="water-stress-due-to-drought-or-wetness">Water Stress due to drought or wetness<a class="anchor" aria-label="anchor" href="#water-stress-due-to-drought-or-wetness"></a>
</h4>
<p>The supply of water is of uttermost importance for crop development.
The water supply depends on weather conditions and the capacity of soils
to buffer and supply water during the growing season. Using long-term
field experiments for multiple crops, empirical relationships between
soil texture, ground water levels, and yield depressions due to drought
or too wet conditions have been developed (Van Bakel, 2005; Huinink,
2018). Within OBIC the crop yield response to drought stress or
wetnessstress can be estimated via the function
<code>bln_p_droughtstress</code> or <code>bln_p_wetnessstress</code>,
requiring as input a soil code (representing unique combinations of soil
type and geohydrological conditions controlling water availability),
crop type, and groundwater level.</p>
<p>For more details, see <code>bln_p_droughtstress</code> and
<code><a href="../reference/bln_p_wetnessstress.html">?bln_p_wetnessstress</a></code>.</p>
<p>An example of this function is illustrated below for six different
soils varying in soil texture and prefixed variation in the groundwater
levels. This is illustrated for both drought and wetness stress.
Increasing the groundwater depth results in more drought stress
(depending on soil texture) and less wetness stress.</p>
<p><br></p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="sealing-soil-surface-and-wind-erodibility">Sealing Soil Surface and Wind Erodibility<a class="anchor" aria-label="anchor" href="#sealing-soil-surface-and-wind-erodibility"></a>
</h4>
<p>Sealing is the process whereby soil aggregates disintegrate under the
influence of rain. The impact of raindrops causes a shifting of soil
particles. In the process, clay and silt particles clog the pores
between the sand particles or the soil aggregates. This creates a slurry
layer that forms a crust after drying. This hinders the gas exchange and
increases the resistance of germinating seed. Wind erosion can occur in
a dry spring or autumn when the soil is (partly) bare. Wind erosion
causes a decrease in organic matter content, moisture retention
capacity, chemical soil fertility, and biological activity in a soil.
Furthermore, wind erosion can spread diseases and weeds, expose
germinating seeds, and damage young plants by sandblasting.</p>
<p>The vulnerability of soils to sealing and wind erosion is derived
from those properties controlling the susceptibility for both risks.
These include the clay content as well as the organic matter content,
where the vulnerability for sealing is derived from field expert-based
observations and associated yield depression in particular for some
arable crops. Wind erosion is highly controlled by the mineralogical
composition and texture as well as the presence of growing crops. Using
laboratory experiments from wind tunnels, a exponential function has
been developed to estimate the erodibility risk for soils, given the
clay and silt content of a field. Grasslands are not susceptible for
these two risks.</p>
<p>The risk for soil sealing can be assessed via the function
<code>bln_p_sealing</code> whereas the risk for soil erosion due to wind
is assessed via the function <code>bln_p_windererosion</code>. The wind
erodibility can be estimated from the inputs land use, clay and silt
content of the topsoil whereas the risk for sealing depends on the clay
content as well as the organic matter content of the soil.</p>
<p>For more details, see <code><a href="../reference/bln_p_sealing.html">?bln_p_sealing</a></code> and
<code><a href="../reference/bln_p_windererosion.html">?bln_p_windererosion</a></code>.</p>
<p>An example of these functions is illustrated below for an arable soil
with variable clay content for both an cropland (with organic matter
levels of 3.5%) and a grassland soil (with organic matter levels of
5%).</p>
<p><br></p>
<pre><code><span><span class="co">#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">#&gt; 3.5.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="aggregate-stability-and-crumbleability">Aggregate Stability and Crumbleability<a class="anchor" aria-label="anchor" href="#aggregate-stability-and-crumbleability"></a>
</h4>
<p>Crumbleability is an indication of the ease with which the soil can
be broken up or crumbled and of the moisture range within which this is
possible. The crumbleability of a soil is determined by the binding
between soil aggregates. The lower the degree of crumbling, the more
energy is required and the heavier tractors and equipment are needed for
working the soil. This requires (additional) investments and higher fuel
consumption, while the end result - even after additional tillage - is
poorer.</p>
<p>Similarly to the vulnerability to sealing and wind erodibility, the
crumbleability of a soil (a measure for aggregate stability) as well as
the potential risk for yield depressions (crop specific) can be derived
from the clay content, the organic matter content, and the pH. Aggregate
stability is additionally evaluated given the cation occupation of the
cation exchange capacity. Clayey soils with 80% Ca, 8% Mg, and about
3.5% K are recognized as soils with more stable aggregates due to the
influence of electrostatic bindings of divalent cations. Within BLN, and
thereby following <span class="citation">[@R-OBIC]</span>, these two
soil functions are assessed using <code>bln_p_crumbleability</code> and
<code>bln_p_aggstability</code>.</p>
<p>For more details, see <code><a href="../reference/bln_p_crumbleability.html">?bln_p_crumbleability</a></code> and
<code><a href="../reference/bln_p_aggstability.html">?bln_p_aggstability</a></code>.</p>
<p>To illustrate how both functions are evaluated, we firstly show the
dependency of the crumbleability to varying clay content using a
constant soil organic matter level of 3.5%. As shown below, the
crumbleability starts at a high value of 10 and gradually declines down
to a value of 6 for soils with a clay content of about 25%. The
aggregate stability depends mainly on the calcium occupation of the CEC.
In the figure below the distance to the optimum CEC occupation is
visualized for a series of soils varying in Ca, Mg and K occupation for
a soil where 100% of the CEC is occupied with a variable contribution of
the three cations. The highest aggregate stability is found when the
distance to the optimum is the lowest, being around a Ca occupation of
about 85% of the CEC.</p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="subsoil-compaction">Subsoil compaction<a class="anchor" aria-label="anchor" href="#subsoil-compaction"></a>
</h4>
<p>Soil compaction is caused by the use of excessively heavy machinery
or by driving over and/or tilling soil with insufficient bearing
capacity. Compaction can lead to poor rooting of the soil, limiting the
absorption of water and nutrients. On heavy soils, compaction mainly
occurs in the soil surface, while on lighter soils there is a risk of
subsoil compaction, such as plough-soil formation. Compaction decreases
the workability of soils and can reduce the water retention capacity of
the soil and impede water transport to deeper layers. This can lead to
an increased risk of surface run-off of nutrients and soil particles.
Soil compaction in the soil can be eliminated by ploughing. Subsoil
compaction is almost impossible to eliminate.</p>
<p>The risk of subsoil compaction for each field was assessed using soil
texture, land use and a soil compaction model SOCOMO. The model
determines whether the usual wheel loads for that land use exceed the
strength of the subsurface in wet or humid conditions. Subsequently it
was determined on the basis of the soil properties and groundwater
levels whether the subsurface is extra sensitive to compaction or
whether natural recovery is possible due to, for example, drought
shrinkage. Strength, land use, and soil properties together determine
the risk of subsoil compaction. The presence of subsoil compaction is
derived from a national map with the estimated risk. As such, there is
no calculation used. Recent field experimental data support the accuracy
of this risk assessment map.</p>
</div>
<div class="section level4">
<h4 id="visual-soil-assessment-correction">Visual Soil Assessment Correction<a class="anchor" aria-label="anchor" href="#visual-soil-assessment-correction"></a>
</h4>
<p>Within the BLN, the estimates of aggregate stability and risk of
subsoil compaction can be adapted to local site specific insights
derived from the Visual Soil Assessment Methodology. Visual soil
assessments (VSA) is an assessment of soil quality in the field, by
digging a hole and assessing several soil quality indicators visually.
Soil quality indicators are: grass cover, number of roots, number of
biopores, soil color, soil structure, soil compaction, and number of
gray spots. Visual soil assessments are more and more used by farmers in
the Netherlands, but not specifically developed for various soil
types.</p>
<p>Below is illustrated how the obic_field wrapper deals with the
parameters derived from the VSA methodology. The score derived from the
original risk assessment map for subsoil compaction is overwritten with
the relevant VSA indicators when When scores are present for the
presence of earthworms (A_EW_BCS), the occurrence of subsurface
compaction (A_SC_BCS), limited root development (A_RD_BCS), ponding in
the spring (wet conditions after rainfall, A_P_BCS) and clear presence
of visible tracks / rutting or trampling on the land (A_RT_BCS).
Similarly, the soil aggregate stability is adapted when VSA indicators
are available for earthworm density (A_EW_BCS), soil structure
(A_SS_BCS), and presence of cracks in the topsoil (A_C_BCS).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># overwrite soil physical functions for compaction when BCS is available</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CO</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">A_EW_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_SC_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_RD_BCS</span>  <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">A_P_BCS</span> <span class="op">-</span> <span class="va">A_RT_BCS</span><span class="op">)</span><span class="op">/</span><span class="fl">18</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CO</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">D_P_CO</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">I_P_CO</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">D_P_CO</span><span class="op">)</span>,<span class="va">I_P_CO</span>,<span class="va">D_P_CO</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># overwrite soil physical functions for aggregate stability when BCS is available</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CEC</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">A_EW_BCS</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">A_SS_BCS</span> <span class="op">-</span> <span class="va">A_C_BCS</span><span class="op">)</span><span class="op">/</span><span class="fl">12</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">D_P_CEC</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">D_P_CEC</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>,<span class="va">I_P_CEC</span> <span class="op">:=</span> <span class="fu">fifelse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">D_P_CEC</span><span class="op">)</span>,<span class="va">I_P_CEC</span>,<span class="va">D_P_CEC</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>In the left figure below one can see how the soil compaction risk is
adapted when information is known from the Visual Soil Assessment. The
soil was originally evaluated as a soil with low compaction, resulting
in a high soil compaction score (the distance to target is small). When
all observations of the VSA have a high quality score (the value 2) then
the score remains the same. As soon as the observations of the VSA show
bottlenecks in the soil structure or rootability (the field score
becomes zero) then the soil compaction score is declined to almost zero
(the distance to target is huge). Similarly, the aggregate stability
score can be adapted, as shown here for a soil with a moderate aggregate
stability index. When field observations support a conclusion for the
soil that the aggregate stability is good (score = 2) then the aggregate
stability index is corrected to the maximum index a soil can retrieve
(the value 1). In contrast, when field observations support the
conclusion of serious bottlenecks for aggregate stability, then the
index declines to almost zero.</p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="water-retention-in-topsoil">Water retention in topsoil<a class="anchor" aria-label="anchor" href="#water-retention-in-topsoil"></a>
</h4>
<p>The moisture characteristic of a soil depends on its physical
properties, texture, and structure. The texture of a soil is determined
by its clay, loam, and sand content. In addition, almost all soils
contain organic matter. The fine soil particles, together with the
organic matter, contribute to aggregate formation (and thus to the soil
structure). The size, shape, and arrangement of the soil particles and
aggregates, and pores, determine the soil’s capacity to retain water.
Large pores are able to conduct more water faster than small pores,
moreover, removing water from large pores will require less energy than
removing water from small pores. When a soil is at field capacity, the
moisture state is such that all the water in the macro pores has been
replaced by air under the influence of the gravitational potential. The
water that is still present in the soil is retained in micro pores. The
prevailing potential at field capacity can vary from soil to soil but
usually varies between -0.1 bar (sandy soil) to -0.3 bar (loamy soil).
When water is retained to such an extent that it is no longer available
for crop uptake, this is known as the wilting point. The water is mainly
present as a film around individual soil particles. The potential under
these conditions is around -18 bar. The amount of moisture present
between field capacity and wilting point is defined as the amount of
plant-available water.</p>
<p>The review study of various soil health instruments (Bunemann et al.,
2016) identifies a variety of indicators that can be used to gain more
insight into the water retaining capacity of a soil. Frequently used
indicators are the amount of plant-available water (14 x), the water
holding capacity (11 x), the moisture content at field capacity (11 x),
and the saturated permeability (10 x). These indicators can be measured
or estimated indirectly via so-called pedotransfer functions.</p>
<p>The BLN makes use of OBIC functions to derive the following
water-related indicators in function
<code><a href="https://rdrr.io/pkg/OBIC/man/calc_waterretention.html" class="external-link">OBIC::calc_waterretention</a></code>. A few examples are illustrated
below:</p>
<ul>
<li>the moisture content at wilting point and field capacity</li>
<li>The amount of plant available water (mm)</li>
<li>the flow limit or porosity, also called water holding capacity,
and</li>
<li>the saturated permeability.</li>
</ul>
<p>The basic indicator used in the BLN is not the amount of plant
available water as implemented in OBIC but the water holding capacity.
The capacity of the soil to buffer water during the growing season is
estimated from pedotransferfunctions (pdf) for plant available water in
the topsoil. The default pdf is derived from a European database, and
enables one to estimate the van Genuchten parameters for the pF-curve.
Other options are also possible.</p>
<p>For more details, see <code><a href="https://rdrr.io/pkg/OBIC/man/calc_waterretention.html" class="external-link">?OBIC::calc_waterretention</a></code>.
Functions are copied into <code>bln_helpers.R</code>. For the
implementation of the WHC assessment, see <code><a href="../reference/bln_p_whc.html">?bln_p_whc</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate the plant available water in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu">calc_waterretention</span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'plant available water'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the water holding capacity in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu">calc_waterretention</span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'water holding capacity'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the moisture content of the wilting point in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu">calc_waterretention</span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'wilting point'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the moisture content of the field capacity in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu">calc_waterretention</span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'field capacity'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the saturated permeability in topsoil</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_WRI</span> <span class="op">:=</span> <span class="fu">calc_waterretention</span><span class="op">(</span><span class="va">A_CLAY_MI</span>,<span class="va">A_SAND_MI</span>,<span class="va">A_SILT_MI</span>,<span class="va">A_SOM_LOI</span>,type <span class="op">=</span> <span class="st">'Ksat'</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Below we illustrate how the amount of water holding capacity (in mm)
changes with clay content, sand content, silt content and soil organic
matter content. All other soil properties are assumed to be
constant.</p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="workability">Workability<a class="anchor" aria-label="anchor" href="#workability"></a>
</h4>
<p>Agricultural fields are not always workable in particular when the
conditions for farm activities are limited by too wet or too dry
conditions. The relative season length, and in extension, the soil
quality assessment for workability, are a function of the soil and
hydrological properties of the field as well as the growing season and
soil working depth requirements of the crop. By choosing a crop with a
shorter growing season and or more shallow soil working depth, the score
can be improved.</p>
<p>For more information of the function, see
<code><a href="../reference/bln_p_workability.html">?bln_p_workability</a></code>.</p>
</div>
<div class="section level4">
<h4 id="bulk-density">Bulk density<a class="anchor" aria-label="anchor" href="#bulk-density"></a>
</h4>
<p>Plant roots are limited in their development when the bulk density
exceeds a certain threshold. To assess the soil quality in view of this
penetration resistance, the bulk density is assessed using the function
<code>bln_p_density</code>. If not measured, it is estimated using a
pedotransfer function commonly applied in the Netherlands. It requires
as input the soil organic matter content (A_SOM_LOI), the clay content
(A_CLAY_MI). For more information, see <code><a href="../reference/bln_p_density.html">?bln_p_density</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="biological-soil-functions">3.3 Biological soil functions<a class="anchor" aria-label="anchor" href="#biological-soil-functions"></a>
</h3>
<p>The BLN assesses also series of soil biological functions related to
the composition of the microbiome, suppression of soil borne pests and
plagues, and plant parasitic nematodes.</p>
<div class="section level4">
<h4 id="potentially-mineralizable-nitrogen">Potentially mineralizable nitrogen<a class="anchor" aria-label="anchor" href="#potentially-mineralizable-nitrogen"></a>
</h4>
<p>The activity of soil fungi and bacteria has been measured via
incubation trials for decades. In such incubation trials, the
decomposition of soil organic nitrogen is measured over a period of
time. The amount of nitrogen that mineralizes in such trials is called
the ‘potential mineralizable nitrogen’(PMN). This indicates the ability
of the soil to provide a crop with readily available nitrogen. In the
Netherlands, this parameter is also used as an indicator for activity of
soil microbes. This is possible because during the incubation, a soil
sample is submerged in water, creating an anaerobic environment, killing
aerobic bacteria and fungi, which, together with some labile organic
matter, are decomposed by anaerobic soil microbes.</p>
<p>For more information see <code><a href="../reference/bln_b_pmn.html">?bln_b_pmn</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># calculate the index for the potential mineralizable nitrogen pool</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_PMN</span> <span class="op">:=</span> <span class="fu"><a href="../reference/bln_b_pmn.html">bln_b_pmn</a></span><span class="op">(</span><span class="va">B_LU_BRP</span>, <span class="va">B_SOILTYPE_AGR</span>, <span class="va">A_N_PMN</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The PMN measured by routine laboratories in the Netherlands may be
overestimated. Therefore, a land-use dependent correction factor is
used. The PMN index is capped at 500. Below an example of this function
is given.</p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="disease-resistance">Disease resistance<a class="anchor" aria-label="anchor" href="#disease-resistance"></a>
</h4>
<p>The activity of the soil life is an indication of the general disease
resistance of the soil. When a soil food web is in balance, the soil’s
resistance to disease and pests is also optimal. The soil’s resistance
to diseases and pests is often cited as a characteristic of a soil with
good biological soil quality. The idea behind this is that a soil with a
well-developed soil food web will be in balance, which means that strong
multiplication of parasitic soil organisms is inhibited by other soil
life. Mechanisms include competition for food or infection sites on the
root, eating the pathogens before they have had a chance to multiply
(myco-parasitism), or secreting (specific) substances that pathogens
cannot tolerate (antibiosis or soil fungistasis).</p>
<p>Organic matter serves as a food source for soil life and influences
the living environment of soil life through its effects on soil
structure and water holding capacity. The quantity and quality of
organic matter can therefore be used as an indicator for the quantity
and activity of soil life, and thus as an indicator for general soil
resilience.</p>
<p>At low organic matter concentrations, the contribution of organic
matter to soil life is negligible. A soil organic matter concentration
between 4% and 10% likely creates the best environment for good disease
resistance.</p>
<p>For more information see <code><a href="../reference/bln_b_diseaseresistance.html">?bln_b_diseaseresistance</a></code>.</p>
<p><img src="bln_ess_crop_production_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="plant-parasitic-nematodes">Plant Parasitic Nematodes<a class="anchor" aria-label="anchor" href="#plant-parasitic-nematodes"></a>
</h4>
<p>Nematodes are small animals occurring in all ecotypes on Earth, so
also in soil. There is a large variety of nematodes in soils, they vary
amongst other things, in size, feeding habits, reproduction speed, and
life cycle. Plant parasitic nematodes (PPN) can reproduce in a range of
host plants. Some nematodes have a specific host preference while other
can reproduce in a large variety of plants. PPN can severely depress
crop yields in vulnerable crops. Therefore, farmers can have their
fields sampled to analyse which and how many nematodes occur.</p>
<p>A nematode parameter that is not entered is assumed to be 0. The
severity of an infection depends on the number of individuals and
differs per parameter. For example: five Pratylenchus fallax
(A_RLN_PR_FAL) will barely reduce the indicator score while five
Ditylenchus destructor (A_SN_DI_DES) will severly reduce the score. It
is assumed that the most severe infection is most limiting for crop
production, therefore, the lowest score for a nematode parameter will
determine the indicator score.</p>
<p>At the moment there is not yet a function for this present in the BLN
due to the fact that actual observations are not present in open
databases or the <code>National Agricultural Soil Archive</code>.</p>
</div>
<div class="section level4">
<h4 id="earthworm-density">Earthworm density<a class="anchor" aria-label="anchor" href="#earthworm-density"></a>
</h4>
<p>Earthworms are some of the largest fauna found in agricultural soils
and through their tunneling affect nutrient cycling and soil structure.
Analysis and interpretation of earthworm diversity is not regularly done
on Dutch agricultural soils. Earth worm density, the number of
individual worms in a volume of soil, is one of the things studied in
the Visual Soil Assessment (see Visual Soil Assessment for more
information).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="crop-and-soil-dependent-applicability-of-functions">4. Crop and soil dependent applicability of functions<a class="anchor" aria-label="anchor" href="#crop-and-soil-dependent-applicability-of-functions"></a>
</h2>
<p>Not all indicators are relevant for all combinations of soil type and
crop. For example, <code>i_p_du</code> (wind erodibility) is not
relevant on permanent grassland, as wind erosion is not a problem on
these parcels. This is accounted for in the aggregation of the BLN
scores. Crops are differentiated into the categories arable, grassland,
maize, and nature according to the crop_category from the table
<code>bln_crops</code>, being a copy of <code><a href="https://rdrr.io/pkg/OBIC/man/crops.obic.html" class="external-link">OBIC::crops.obic</a></code>.
In soil type a differentiation is made between peat and non peat soils.
If an indicator is not relevant for a given parcel, its score will not
be used in further aggregation.</p>
</div>
<div class="section level2">
<h2 id="reading-more">5. Reading more?<a class="anchor" aria-label="anchor" href="#reading-more"></a>
</h2>
<p>More vignettes will be made available regarding the derivation of all
soil health indicators, the aggregation methods applied, the derivation
of optimum land use given the current soil quality assessments, and the
best management practices to be applied to improve the soil quality. Are
you interested to contribute, please contact the author(s) of this R
package. Enjoy!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gerard Ros, Sven Verweij, Yuki Fujita, Noud van Dam, Brent Riechelman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
